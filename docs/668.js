"use strict";(self.webpackChunkrust_webpack_template=self.webpackChunkrust_webpack_template||[]).push([[668],{668:(e,t,n)=>{n.r(t);var r=n(838);const o=window.location.search;let l=new URLSearchParams(o);var i="daily-"+(new Date).toISOString().slice(0,10);l.has("seed")?(i=l.get("seed"),console.log("Taking seed from url param '"+i+"'")):console.log("Using daily seed '"+i+"'"),window.history.replaceState({},"","/?seed="+i),document.getElementById("apply_seed").addEventListener("click",(()=>{window.location.replace("/?seed="+document.getElementById("game_seed_input").value)}));var s=void 0,_=["#FCDDFF","#FFFFCF","#D9FFDF","#D9FFFF"];function u(e,t,n){if(e.children.length>0){const t=e.insertRow(-1);for(let e=0;e<4;e++)t.insertCell(-1)}const r=e.insertRow(-1);r.insertCell(-1).innerHTML="Message";for(let e of t.clues)r.insertCell(-1).innerHTML="<b>"+e+"</b>";const o=turn_table_body.insertRow(-1);o.insertCell(-1).innerHTML="Decoded";for(let e of t.message){const t=o.insertCell(-1);n?t.innerHTML="???":(t.innerHTML=e.toString(),t.style.backgroundColor=_[e],t.style.color="black")}if(null!=t.player_guess){const e=turn_table_body.insertRow(-1);e.insertCell(-1).innerHTML="Guess";for(let n=0;n<t.player_guess.length;n++){let r=t.player_guess[n];var l=t.message[n];const o=e.insertCell(-1);var i=r.toString();r===l&&(o.style.backgroundColor=_[l],o.style.color="black",i+=" (Correct)"),o.innerHTML=i}}if(n){const e=turn_table_body.insertRow(-1);e.insertCell(-1).innerHTML="Guess";let t=[];for(let n=0;n<3;n++){e.insertCell(-1).innerHTML='<select id="input_'+n.toString()+'"><option value="">Guess</option><option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option></select>';let r=document.getElementById("input_"+n.toString());t.push(r)}for(let e=0;e<3;e++)t[e].addEventListener("input",g(t)),t[e].addEventListener("keypress",f)}}function c(e){if(e){let e=parseInt(document.getElementById("input_0").value),t=parseInt(document.getElementById("input_1").value),n=parseInt(document.getElementById("input_2").value);s.next_turn(e,t,n)}else s.next_turn_noguess();a(!1)}function a(e){const t=s.correct_guess_count(),n=2==t;let r=JSON.parse(s.get_past_turns_json()),o=null;if(n||e||(o=JSON.parse(s.get_current_turn_json())),function(e,t){const n=document.getElementById("turn_table_body");n.innerHTML="";for(let t of e)u(n,t,!1);null!=t&&u(n,t,!0)}(r,o),n||e){document.getElementById("button_controls").innerHTML="",document.getElementById("correct_guess_count").innerHTML=n?"You won in "+r.length+" turns!":"You gave up :(";const e=document.getElementById("secret_words").insertRow(-1),t=JSON.parse(s.get_secret_words());e.insertCell(-1).innerHTML="Secret words: ";for(let n=0;n<t.length;n++){let r=t[n];const o=e.insertCell(-1);o.innerHTML=r,o.style.backgroundColor=_[n],o.style.color="black"}document.getElementById("play_again").innerHTML="<button id='play_again_button'>Play again</button>",document.getElementById("play_again_button").addEventListener("click",(()=>{document.getElementById("secret_words").innerHTML="",document.getElementById("play_again").innerHTML="",b(Math.floor(1e3*Math.random()*1e3).toString())}))}else document.getElementById("correct_guess_count").innerHTML="Correctly decoded sequences: "+t.toString()+"/2"}function d(e,t){let n=t[e];if(n.length>1)return!1;if(1==n.length){if(n[0]<"0"&&n[0]>"3")return!1;for(let r=0;r<t.length;r++)if(r!=e&&n===t[r])return!1}return!0}function g(e){return()=>{for(let n=0;n<e.length;n++){let r=e[n],o=r.value;r.value=((t=o).length>1&&(t=t.substr(0,1)),1==t.length&&(t[0]<"0"||t[0]>"3")?"":t),d(n,e.map((e=>e.value)))?r.style.backgroundColor="":(r.style.backgroundColor="#FCBAB1",r.style.color="black")}var t}}function f(e){13==e.keyCode&&p()}function p(){let e=[0,1,2].map((e=>document.getElementById("input_"+e.toString()))).map((e=>e.value));for(let t=0;t<e.length;t++)if(0==e[t].length||!d(t,e))return!1;return c(!0),!0}const y="fasttext_filtered.embspace";function b(e){document.getElementById("button_controls").innerHTML="<button id='submit'>Submit</button>&nbsp;<button id='give_up'>Give up</button>",document.getElementById("submit").addEventListener("click",(()=>{p()})),document.getElementById("give_up").addEventListener("click",(()=>{a(!0)})),document.getElementById("game_seed_input").value=e,s.new_game(e),s.next_turn_noguess(),s.next_turn_noguess(),c(!1)}console.log("Fetching embedding "+y),fetch(y).then((e=>e.blob())).then((e=>e.arrayBuffer())).then((e=>{const t=new Uint8Array(e);s=new r.KU(t),b(i)}))},838:(e,t,n)=>{n.d(t,{KU:()=>m,h4:()=>w,r2:()=>h,ug:()=>v,Ih:()=>k,yq:()=>E,gk:()=>I,Or:()=>L});var r=n(373);e=n.hmd(e);let o=new("undefined"==typeof TextDecoder?(0,e.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});o.decode();let l=null;function i(){return null!==l&&l.buffer===r.memory.buffer||(l=new Uint8Array(r.memory.buffer)),l}function s(e,t){return o.decode(i().subarray(e,e+t))}const _=new Array(32).fill(void 0);_.push(void 0,null,!0,!1);let u=_.length;function c(e){u===_.length&&_.push(_.length+1);const t=u;return u=_[t],_[t]=e,t}function a(e){return _[e]}let d=0,g=new("undefined"==typeof TextEncoder?(0,e.require)("util").TextEncoder:TextEncoder)("utf-8");const f="function"==typeof g.encodeInto?function(e,t){return g.encodeInto(e,t)}:function(e,t){const n=g.encode(e);return t.set(n),{read:e.length,written:n.length}};function p(e,t,n){if(void 0===n){const n=g.encode(e),r=t(n.length);return i().subarray(r,r+n.length).set(n),d=n.length,r}let r=e.length,o=t(r);const l=i();let s=0;for(;s<r;s++){const t=e.charCodeAt(s);if(t>127)break;l[o+s]=t}if(s!==r){0!==s&&(e=e.slice(s)),o=n(o,r,r=s+3*e.length);const t=i().subarray(o+s,o+r);s+=f(e,t).written}return d=s,o}let y=null;function b(){return null!==y&&y.buffer===r.memory.buffer||(y=new Int32Array(r.memory.buffer)),y}class m{static __wrap(e){const t=Object.create(m.prototype);return t.ptr=e,t}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();r.__wbg_client_free(e)}constructor(e){var t=function(e,t){const n=t(1*e.length);return i().set(e,n/1),d=e.length,n}(e,r.__wbindgen_malloc),n=d,o=r.client_new(t,n);return m.__wrap(o)}new_game(e){var t=p(e,r.__wbindgen_malloc,r.__wbindgen_realloc),n=d;r.client_new_game(this.ptr,t,n)}next_turn(e,t,n){r.client_next_turn(this.ptr,e,t,n)}next_turn_noguess(){r.client_next_turn_noguess(this.ptr)}get_seed(){try{const n=r.__wbindgen_add_to_stack_pointer(-16);r.client_get_seed(n,this.ptr);var e=b()[n/4+0],t=b()[n/4+1];return s(e,t)}finally{r.__wbindgen_add_to_stack_pointer(16),r.__wbindgen_free(e,t)}}get_current_turn_json(){try{const n=r.__wbindgen_add_to_stack_pointer(-16);r.client_get_current_turn_json(n,this.ptr);var e=b()[n/4+0],t=b()[n/4+1];return s(e,t)}finally{r.__wbindgen_add_to_stack_pointer(16),r.__wbindgen_free(e,t)}}get_past_turns_json(){try{const n=r.__wbindgen_add_to_stack_pointer(-16);r.client_get_past_turns_json(n,this.ptr);var e=b()[n/4+0],t=b()[n/4+1];return s(e,t)}finally{r.__wbindgen_add_to_stack_pointer(16),r.__wbindgen_free(e,t)}}correct_guess_count(){return r.client_correct_guess_count(this.ptr)>>>0}get_secret_words(){try{const n=r.__wbindgen_add_to_stack_pointer(-16);r.client_get_secret_words(n,this.ptr);var e=b()[n/4+0],t=b()[n/4+1];return s(e,t)}finally{r.__wbindgen_add_to_stack_pointer(16),r.__wbindgen_free(e,t)}}get_telemetry_data_json(){try{const n=r.__wbindgen_add_to_stack_pointer(-16);r.client_get_telemetry_data_json(n,this.ptr);var e=b()[n/4+0],t=b()[n/4+1];return s(e,t)}finally{r.__wbindgen_add_to_stack_pointer(16),r.__wbindgen_free(e,t)}}}function w(e,t){return c(s(e,t))}function h(e){console.log(a(e))}function v(e){!function(e){const t=a(e);(function(e){e<36||(_[e]=u,u=e)})(e)}(e)}function k(){return c(new Error)}function E(e,t){var n=p(a(t).stack,r.__wbindgen_malloc,r.__wbindgen_realloc),o=d;b()[e/4+1]=o,b()[e/4+0]=n}function I(e,t){try{console.error(s(e,t))}finally{r.__wbindgen_free(e,t)}}function L(e,t){throw new Error(s(e,t))}},373:(e,t,n)=>{var r=n.w[e.id];e.exports=r,n(838),r[""]()}}]);